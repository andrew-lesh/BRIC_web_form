<!-- Hi Fox!!! c: -->
<!-- andrew ur so cool B) -->


<!--
    1. Multiple Choice bubble thing for 13 and over 
        (bubble for 13 or over, bubble for below 13)
          If 13 or over, first and last name fields appear
          If below 13, first name field appears and parent signature field appears
            If parent name typed into parent signature field, last name field appears
    2. Field for "Sending your wish to space" (character limit TBD (do we want to stop people from
        pasting the entire bee movie script?  That would be funny lol))
            Need disclaimer to warn user from typing personally identifiable information (address, SSN, horoscope, genome, email)
    3. Submit button that submits data to storage and generates certificate for client-side printing 
            Dialogue box appears to notify of successful submission
    4. Privacy policy on page states that names are only collected to be stored on sd card and that parent 
       signatures are only collected to indicate parental approval.

    https://api.apispreadsheets.com/data/15941/
    -->


<!DOCTYPE html>
<html>
<head>
<title>Save Web Form Data to Spreadsheets - Contact Form</title>

<!--Import jquery-->
<script
    src="https://code.jquery.com/jquery-3.4.1.js"
    integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
    crossorigin="anonymous"></script>
<script>

// form submission jquery code that we stole
function SubForm (){
    $.ajax({
        url:'https://api.apispreadsheets.com/data/15941/',
        type:'post',
        data:$("#myForm").serializeArray(),
        success: function(){
            alert("Form Data Submitted :)")
        },
        error: function(){
            alert("There was an error :(")
        }
    });
}

// saves "fullName" locally so that we can use it for the certificate later 
function SaveName(){
    var inputName= document.getElementById("fullName");
    sessionStorage.setItem("fullName", inputName.value);
}

// will make the fullName show up when you hit the button
const listen = event => {
        const p = document.createElement('p');
        
        var storedValue = sessionStorage.getItem("fullName");
        p.innerText = storedValue;
        document.querySelector('#container').appendChild(p);
}

</script>

</head>
<body>
    <!--Make the form. Once again code that we stole lol-->
    <form id="myForm">

    <!--Name-->
    <label for = "fullName">Full Name</label>
    <br/>
    <input type = "text" id = "fullName" name="full_name" />
    <br/>
    
    <!--Email-->
    <label>Email</label>
    <br/>
    <input name="email" />
    <br/>

    <!--Age-->
    <label>Age</label>
    <br/>
    <input type="radio" id="age" name="age" value="18-35" /> 18-35<br/>
    <input type="radio" id="age" name="age" value="35+" /> 35+<br/>
    <br/>
    
    <!--Message-->
    <label>Message</label>
    <br/>
    <textarea name="message">
    </textarea>
    <br/>
    <br/>

    </form>

    <!--Button to submit the form and save the fullName-->
    <button onclick="SubForm(); SaveName();">Submit your name and message to the ISS!</button>
    <br/><br/>

    <!--Button to make the crigull show up-->
    <button onclick="DrawCanvas();">Generate your certificate!</button>
    <br/><br/>

    <!--Button to make the fullName show up-->
    <div id="container">
        <button onclick="listen()" id="button">Make your name show up here lmao</button>
    </div>


    <!--Button to make download thing-->
    <button onclick="save2()">Save</button>

    <!--Initialize the image and canvas-->
    <img id="canvasimg" src="" />
    <!-- <img hidden id="crigull" crossOrigin = '' width="220" height="277" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Common_lionfish_at_Shaab_El_Erg_reef.JPG/1000px-Common_lionfish_at_Shaab_El_Erg_reef.JPG" alt="crigull"> -->
    <canvas id="myCanvas" width="240" height="297" style="border:1px solid #d3d3d3;"></canvas>

<script>
    // Function to make the certificate show up
    function DrawCanvas(){
        window.onclick = function() {
            var c = document.getElementById("myCanvas");
            var ctx = c.getContext("2d");
            var img = new Image();
            img.crossOrigin = 'Anonymous';
            
            img.onload = function() {
                ctx.drawImage(img, 10, 10, 220, 277);
                ctx.font = "30px Arial";
                var storedValue = sessionStorage.getItem("fullName");
                ctx.fillText(storedValue, 10, 50);

                var dataUrl = String(c.toDataURL());

                sessionStorage.setItem("storedURL", dataUrl);
            }

            img.src = 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Common_lionfish_at_Shaab_El_Erg_reef.JPG/1000px-Common_lionfish_at_Shaab_El_Erg_reef.JPG';
        }
    }

    function save2() {
        var dataUrl = sessionStorage.getItem("storedURL");
        var a  = document.createElement('a');
        a.href = dataUrl;
        a.download = 'image.png';

        a.click()
        
    }
</script>

</body>
</html>